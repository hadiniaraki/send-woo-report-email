# send-woo-report-email
send everyday sell reports by email
# WooCommerce Daily Sales Report Emailer

This Python script fetches completed orders from a WooCommerce store for the previous day, generates a styled Excel report, and sends it via email to specified recipients. It's designed to run automatically on a daily schedule.

## Features

* **Daily Order Fetching:** Retrieves all "completed" orders from the previous day using the WooCommerce REST API.
* **Custom Order Numbers:** Automatically uses custom order numbers generated by plugins like "Sequential Order Numbers" instead of the default WooCommerce order ID.
* **Jalali Date Conversion:** Displays order dates in the Jalali (Shamsi) calendar format within the Excel report.
* **Refund Handling:** Accurately calculates item quantities and total order amount by accounting for refunds.
* **Styled Excel Report:**
    * Auto-fits column widths based on content.
    * Freezes the header row for easy scrolling.
    * Applies distinct background colors to the header and the "نام آیتم‌ها" (Item Names) column.
    * Enables text wrapping for multi-line content (e.g., item names, quantities, address).
* **Automated Email Delivery:** Sends the generated Excel report as an attachment via email.
* **Configurable via `.env`:** All sensitive credentials (API keys, email passwords) and recipient addresses are loaded from an environment file for security and easy management.
* **Minimal Logging:** Designed to log only critical errors and essential information to keep logs clean.

## Prerequisites

Before deploying and running this script, ensure you have the following:

* **Python 3:** Installed on your server (version 3.8+ recommended).
* **WooCommerce Store:** Access to your WooCommerce store with REST API enabled.
* **WooCommerce API Keys:** Consumer Key and Consumer Secret with Read permissions for Orders.
* **Email Account:** An email account (and its SMTP server details) from which to send reports.
* **SMTP Access:** Ensure your server allows outbound connections to your SMTP server's port (usually 587 or 465).

## Installation and Deployment on Ubuntu

Follow these steps to deploy the script on an Ubuntu server.

### 1. Clone the Repository

First, connect to your Ubuntu server via SSH and clone this repository:

```bash
ssh your_username@your_server_ip
git clone [https://github.com/hadiniaraki/send-woo-report-email.git](https://github.com/hadiniaraki/send-woo-report-email.git)
cd send-woo-report-email